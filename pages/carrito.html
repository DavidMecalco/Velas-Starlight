<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Carrito de Compras | Velas Starlight</title>

    <!-- SEO Meta Tags -->
    <meta name="description"
        content="Revisa y completa tu compra de velas artesanales y productos de belleza natural. Proceso de compra seguro y fácil.">
    <meta name="keywords" content="carrito compras velas, checkout velas artesanales, comprar velas México">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
    <meta property="og:title" content="Carrito de Compras | Velas Starlight">
    <meta property="og:description" content="Completa tu compra de velas artesanales premium">
    <meta property="og:image" content="../images/og-carrito.jpg">
    <meta property="og:url" content="">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'beige-almond': '#F6F1E9',
                        'dark-green': '#2D3E33',
                        'warm-cream': '#EDE6DA',
                        'sage-green': '#3A5A40',
                        'leaf-green': '#A3B18A',
                        'gray-sand': '#D6CEC3',
                        'accent-gold': '#D4AF37',
                        'soft-pink': '#F8E8E8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'scale-in': 'scaleIn 0.4s ease-out',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    backdropBlur: {
                        xs: '2px',
                    }
                }
            }
        }
    </script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../images/favicon.png">

    <!-- jsPDF para generar PDFs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Generador profesional de cotización PDF -->
    <script src="../js/quote-pdf-professional.js"></script>

    <!-- Estilos responsivos mejorados -->
    <link rel="stylesheet" href="../css/carrito-responsive-fixes.css">

    <!-- Estilos Premium -->
    <style>
        /* Variables CSS Premium */
        :root {
            --primary: #1a1a1a;
            --secondary: #2D3E33;
            --accent: #A3B18A;
            --gold: #D4AF37;
            --cream: #FEFEFE;
            --warm: #F8F6F3;
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F5;
            --gray-200: #EEEEEE;
            --gray-300: #E0E0E0;
            --gray-400: #BDBDBD;
            --gray-500: #9E9E9E;
            --gray-600: #757575;
            --gray-700: #616161;
            --gray-800: #424242;
            --gray-900: #212121;
            --shadow-soft: 0 2px 20px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-strong: 0 20px 40px rgba(0, 0, 0, 0.15);
            --radius: 16px;
            --radius-lg: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Reset y base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, var(--warm) 0%, #F5F3F0 100%);
            color: var(--primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Animaciones elegantes */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* Header Premium */
        .header-premium {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--gray-200);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            transition: var(--transition);
        }

        .header-premium.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: var(--shadow-soft);
        }

        /* Contenedor principal */
        .container-premium {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Hero Section Premium - Estilo minimalista como en la imagen */
        .hero-premium {
            background: linear-gradient(135deg, var(--warm) 0%, #F5F3F0 100%);
            padding: 8rem 0 4rem;
            position: relative;
            overflow: hidden;
        }

        .hero-premium::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23A3B18A" fill-opacity="0.03"><circle cx="20" cy="20" r="1"/></g></g></svg>');
            pointer-events: none;
        }

        .hero-content {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 1.5rem;
            letter-spacing: -0.02em;
            animation: fadeIn 0.8s ease-out;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            color: var(--gray-600);
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            animation: fadeIn 0.8s ease-out 0.2s both;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 3rem;
            animation: fadeIn 0.8s ease-out 0.4s both;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-number {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--secondary);
            display: block;
        }

        .hero-stat-label {
            font-size: 0.875rem;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* Filtros Premium - Estilo minimalista */
        .filters-premium {
            background: var(--cream);
            padding: 2rem 0;
            border-bottom: 1px solid var(--gray-200);
            position: sticky;
            top: 80px;
            z-index: 100;
            backdrop-filter: blur(20px);
        }

        .filters-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .filter-categories {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            border: 2px solid var(--gray-200);
            background: var(--cream);
            color: var(--gray-600);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(163, 177, 138, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .filter-btn:hover::before {
            left: 100%;
        }

        .filter-btn:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
        }

        .filter-btn.active {
            background: var(--secondary);
            border-color: var(--secondary);
            color: white;
            box-shadow: var(--shadow-medium);
        }

        /* Cart Section Premium */
        .cart-section-premium {
            padding: 4rem 0;
            min-height: 60vh;
        }

        .cart-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 3rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Cart Items Premium */
        .cart-items-premium {
            background: var(--cream);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .cart-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .cart-stats {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .cart-stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Product Card Premium */
        .product-card-premium {
            background: var(--cream);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
            transition: var(--transition);
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
        }

        .product-card-premium:hover {
            box-shadow: var(--shadow-medium);
            transform: translateY(-2px);
        }

        .product-image-premium {
            width: 120px;
            height: 120px;
            border-radius: var(--radius);
            object-fit: cover;
            flex-shrink: 0;
            box-shadow: var(--shadow-soft);
        }

        .product-info-premium {
            flex: 1;
        }

        .product-category-premium {
            font-size: 0.875rem;
            color: var(--accent);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .product-title-premium {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.75rem;
            line-height: 1.3;
        }

        .product-features-premium {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .product-feature-premium {
            padding: 0.25rem 0.75rem;
            background: var(--gray-100);
            border-radius: 50px;
            font-size: 0.75rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .product-controls-premium {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--gray-100);
            padding: 0.5rem;
            border-radius: var(--radius);
        }

        .qty-btn {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            border: none;
            background: var(--secondary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
            font-weight: 600;
        }

        .qty-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        .qty-display {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            min-width: 3rem;
            text-align: center;
        }

        .product-price-premium {
            text-align: right;
        }

        .price-current {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--secondary);
        }

        .price-unit {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-top: 0.25rem;
        }

        .remove-btn {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: #ef4444;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            margin-left: 1rem;
        }

        .remove-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        /* Summary Card Premium */
        .summary-card-premium {
            background: var(--cream);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--gray-200);
            position: sticky;
            top: 100px;
            height: fit-content;
        }

        .summary-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .summary-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .summary-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .summary-line:last-child {
            border-bottom: none;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--secondary);
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--gray-200);
        }

        .shipping-notice {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--gray-100);
            border-radius: var(--radius);
            font-size: 0.875rem;
            color: var(--gray-600);
            margin: 0.75rem 0;
            border-left: 3px solid var(--accent);
        }

        .shipping-notice i {
            color: var(--accent);
            font-size: 1rem;
        }

        .btn-checkout {
            width: 100%;
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .btn-checkout:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-strong);
        }

        .btn-continue {
            width: 100%;
            background: transparent;
            color: var(--secondary);
            border: 2px solid var(--secondary);
            padding: 0.875rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .btn-continue:hover {
            background: var(--secondary);
            color: white;
        }

        /* Empty Cart Premium */
        .empty-cart-premium {
            text-align: center;
            padding: 4rem 2rem;
            background: var(--cream);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
        }

        .empty-cart-icon {
            font-size: 4rem;
            color: var(--gray-300);
            margin-bottom: 2rem;
        }

        .empty-cart-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .empty-cart-description {
            color: var(--gray-600);
            font-size: 1.125rem;
            margin-bottom: 2rem;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .btn-shop {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .btn-shop:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        /* Discount Section Premium */
        .discount-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--gray-200);
        }

        .discount-header {
            margin-bottom: 1rem;
        }

        .discount-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .discount-input-container {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            align-items: stretch;
        }

        .discount-input {
            flex: 1;
            min-width: 0;
            padding: 0.875rem 1rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background: var(--gray-50);
        }

        .discount-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: var(--shadow-soft);
            background: white;
        }

        .btn-apply-discount {
            flex-shrink: 0;
            padding: 0.875rem 1.5rem;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            min-width: fit-content;
        }

        .btn-apply-discount:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-apply-discount:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .discount-message {
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .discount-message.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .discount-message.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }

        .discount-suggestions {
            margin-top: 1rem;
        }

        .discount-suggestions-text {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 0.75rem;
            font-weight: 500;
        }

        .discount-codes {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .discount-code-btn {
            padding: 0.5rem 0.875rem;
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-700);
            cursor: pointer;
            transition: var(--transition);
        }

        .discount-code-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            transform: translateY(-1px);
        }

        .discount-applied {
            background: #d1fae5 !important;
            color: #065f46 !important;
            border-color: #a7f3d0 !important;
        }

        /* Responsive Premium */
        @media (max-width: 1024px) {
            .cart-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .summary-card-premium {
                position: static;
            }

            .hero-title {
                font-size: 3rem;
            }

            .hero-stats {
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .container-premium {
                padding: 0 1rem;
            }

            .hero-premium {
                padding: 6rem 0 3rem;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .hero-subtitle {
                font-size: 1.25rem;
            }

            .hero-stats {
                flex-direction: column;
                gap: 1.5rem;
            }

            .cart-items-premium,
            .summary-card-premium {
                padding: 1.5rem;
            }

            .product-card-premium {
                flex-direction: column;
                text-align: center;
            }

            .product-image-premium {
                align-self: center;
            }

            .product-controls-premium {
                flex-direction: column;
                gap: 1.5rem;
            }

            .filters-container {
                flex-direction: column;
                align-items: stretch;
                gap: 1.5rem;
            }

            .filter-categories {
                justify-content: center;
            }

            .discount-input-container {
                flex-direction: column;
                gap: 1rem;
            }

            .btn-apply-discount {
                width: 100%;
                justify-content: center;
                padding: 1rem 1.5rem;
            }

            .discount-codes {
                justify-content: center;
            }

            /* Mejoras adicionales para móviles */
            .header-premium {
                padding: 0.5rem 1rem;
            }

            .cart-section-premium {
                padding: 2rem 0;
            }

            .cart-container {
                padding: 0 1rem;
                gap: 1.5rem;
            }

            /* Navegación móvil mejorada */
            .mobile-menu {
                max-height: 80vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }

            /* Botones más grandes para móviles */
            .qty-btn,
            .remove-btn {
                min-height: 44px;
                min-width: 44px;
            }

            /* Texto más legible en móviles */
            .product-title-premium {
                font-size: 1.25rem;
                line-height: 1.3;
            }

            .product-category-premium {
                font-size: 0.8rem;
            }

            /* Espaciado mejorado */
            .product-card-premium {
                margin-bottom: 1rem;
                padding: 1.25rem;
            }

            /* Summary card sticky en móviles */
            .summary-card-premium {
                position: sticky;
                top: 20px;
                z-index: 10;
            }
        }

        /* Mejoras para pantallas muy pequeñas */
        @media (max-width: 480px) {
            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .cart-items-premium,
            .summary-card-premium {
                padding: 1rem;
            }

            .product-card-premium {
                padding: 1rem;
            }

            .product-image-premium {
                width: 80px;
                height: 80px;
            }

            .product-title-premium {
                font-size: 1.125rem;
            }

            .cart-title {
                font-size: 1.25rem;
            }

            .summary-title {
                font-size: 1.25rem;
            }

            /* Ocultar elementos menos importantes en pantallas muy pequeñas */
            .hero-stats {
                display: none;
            }

            .product-features-premium .product-feature-premium:nth-child(n+3) {
                display: none;
            }
        }

        /* Checkout Section Premium */
        .checkout-section-premium {
            padding: 4rem 0;
            background: linear-gradient(135deg, var(--warm) 0%, #F5F3F0 100%);
            position: relative;
            overflow: hidden;
        }

        .checkout-section-premium::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23A3B18A" fill-opacity="0.03"><circle cx="20" cy="20" r="1"/></g></g></svg>');
            pointer-events: none;
        }

        .checkout-section-premium.hidden {
            display: none;
        }

        .checkout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--gray-200);
            position: relative;
            z-index: 1;
        }

        .checkout-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: fadeIn 0.8s ease-out;
        }

        .btn-back {
            background: transparent;
            color: var(--secondary);
            border: 2px solid var(--secondary);
            padding: 0.875rem 1.5rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-back:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-2px);
        }

        .checkout-form {
            background: var(--cream);
            border-radius: var(--radius-lg);
            padding: 3rem;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
            position: relative;
            z-index: 1;
            animation: slideUp 0.6s ease-out;
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .form-section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group-full {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .form-input {
            padding: 0.875rem 1rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background: var(--gray-50);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: var(--shadow-soft);
            background: white;
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .order-summary {
            background: var(--gray-50);
            border-radius: var(--radius);
            padding: 1.5rem;
        }

        .checkout-items {
            margin-bottom: 1.5rem;
        }

        .checkout-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .checkout-item:last-child {
            border-bottom: none;
        }

        .checkout-item-info {
            flex: 1;
        }

        .checkout-item-name {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .checkout-item-details {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .checkout-item-price {
            font-weight: 600;
            color: var(--secondary);
        }

        .checkout-totals {
            border-top: 1px solid var(--gray-200);
            padding-top: 1rem;
        }

        .checkout-total-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
        }

        .checkout-total-final {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--secondary);
            border-top: 1px solid var(--gray-200);
            margin-top: 0.5rem;
            padding-top: 1rem;
        }

        .shipping-note {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 0.75rem;
            background: rgba(163, 177, 138, 0.1);
            border-radius: var(--radius);
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        .shipping-note i {
            color: var(--accent);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--gray-200);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-secondary {
            background: transparent;
            color: var(--secondary);
            border: 2px solid var(--secondary);
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-secondary:hover {
            background: var(--secondary);
            color: white;
        }

        /* Quote Section Premium */
        .quote-section {
            position: relative;
            z-index: 1;
        }

        .quote-section.hidden {
            display: none;
        }

        .quote-content {
            display: grid;
            gap: 2rem;
            animation: slideUp 0.6s ease-out;
        }

        .quote-card {
            background: var(--cream);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
        }

        .quote-card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .customer-info,
        .shipping-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 1rem;
            color: var(--primary);
            font-weight: 500;
        }

        /* Aviso de Construcción Rediseñado */
        .construction-banner {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .construction-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .construction-icon {
            font-size: 2rem;
            color: #f59e0b;
            flex-shrink: 0;
        }

        .construction-info h4 {
            font-size: 1.125rem;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 0.25rem;
        }

        .construction-info p {
            color: #92400e;
            font-weight: 500;
            margin: 0;
        }

        /* Grid de Proceso Rediseñado */
        .process-grid {
            display: grid;
            gap: 1.5rem;
        }

        .process-item {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            transition: var(--transition);
        }

        .process-item:hover {
            background: white;
            box-shadow: var(--shadow-soft);
            transform: translateY(-2px);
        }

        .process-icon {
            flex-shrink: 0;
        }

        .process-number {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
        }

        .process-info h4 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .process-info p {
            color: var(--gray-600);
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .contact-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .contact-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.875rem;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .contact-btn.email {
            background: var(--gray-200);
            color: var(--primary);
            border-color: var(--gray-300);
        }

        .contact-btn.email:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-1px);
        }

        .contact-btn.whatsapp {
            background: #25d366;
            color: white;
        }

        .contact-btn.whatsapp:hover {
            background: #128c7e;
            transform: translateY(-1px);
        }

        .quote-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .btn-download {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-email {
            background: linear-gradient(135deg, #1f2937, #374151);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-email:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25d366, #128c7e);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .btn-whatsapp:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
            color: white;
        }

        /* Responsive para checkout */
        @media (max-width: 768px) {
            .checkout-header {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }

            .checkout-title {
                font-size: 2rem;
            }

            .checkout-form {
                padding: 2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .customer-info,
            .shipping-info {
                grid-template-columns: 1fr;
            }

            .construction-notice {
                flex-direction: column;
                text-align: center;
            }

            .contact-options {
                justify-content: center;
            }

            .quote-actions {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>

<body>
    <!-- Header Premium -->
    <header class="header-premium" id="header">
        <div class="container-premium">
            <div class="flex justify-between items-center py-4">
                <!-- Logo -->
                <a href="../index.html" class="flex items-center">
                    <img src="../images/logo.png" alt="Velas Starlight Logo" class="h-12 w-auto">
                </a>

                <!-- Navigation Desktop -->
                <nav class="hidden md:flex space-x-8 font-medium items-center">
                    <a href="../index.html"
                        class="text-gray-700 hover:text-dark-green transition-colors duration-300 flex items-center gap-2">
                        <i class="fa fa-home"></i>Inicio
                    </a>
                    <a href="productos.html"
                        class="text-gray-700 hover:text-dark-green transition-colors duration-300 flex items-center gap-2">
                        <i class="fa fa-cube"></i>Productos
                    </a>
                    <a href="contacto.html"
                        class="text-gray-700 hover:text-dark-green transition-colors duration-300 flex items-center gap-2">
                        <i class="fa fa-phone"></i>Contacto
                    </a>
                    <!-- Cart -->
                    <a href="carrito.html" class="relative text-dark-green transition-colors duration-300">
                        <i class="fa fa-shopping-cart text-xl"></i>
                        <span id="cart-count"
                            class="absolute -top-3 -right-3 bg-dark-green text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">0</span>
                    </a>
                </nav>

                <!-- Mobile Menu Button -->
                <button id="menu-toggle" class="md:hidden text-dark-green text-2xl">
                    <i class="fa fa-bars"></i>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu"
                class="hidden md:hidden bg-white shadow-xl border-t border-gray-100 absolute top-full left-0 w-full z-50">
                <div class="px-6 py-4 space-y-1">
                    <a href="../index.html"
                        class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200 group">
                        <i
                            class="fa fa-home mr-3 text-dark-green group-hover:scale-110 transition-transform duration-200"></i>
                        <span class="font-medium">Inicio</span>
                    </a>
                    <a href="productos.html"
                        class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200 group">
                        <i
                            class="fa fa-cube mr-3 text-dark-green group-hover:scale-110 transition-transform duration-200"></i>
                        <span class="font-medium">Productos</span>
                    </a>
                    <a href="contacto.html"
                        class="flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 rounded-lg transition-all duration-200 group">
                        <i
                            class="fa fa-phone mr-3 text-dark-green group-hover:scale-110 transition-transform duration-200"></i>
                        <span class="font-medium">Contacto</span>
                    </a>
                    <div class="border-t border-gray-200 my-2"></div>
                    <a href="carrito.html"
                        class="flex items-center justify-between px-4 py-3 text-dark-green bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <i class="fa fa-shopping-cart mr-3"></i>
                            <span class="font-medium">Carrito</span>
                        </div>
                        <span id="cart-count-mobile"
                            class="bg-dark-green text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">0</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section Premium - Estilo minimalista -->
    <section class="hero-premium">
        <div class="container-premium">
            <div class="hero-content">
                <h1 class="hero-title">Carrito</h1>
                <p class="hero-subtitle">Revisa tus productos seleccionados y completa tu pedido de manera fácil y
                    segura</p>

                <div class="hero-stats">
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="hero-items-count">0</span>
                        <span class="hero-stat-label">PRODUCTOS</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number" id="hero-units-count">0</span>
                        <span class="hero-stat-label">UNIDADES</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number">100%</span>
                        <span class="hero-stat-label">SEGURO</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Section Premium -->
    <section class="cart-section-premium">
        <div class="cart-container">
            <!-- Cart Items -->
            <div class="cart-items-premium">
                <div class="cart-header">
                    <div>
                        <h2 class="cart-title">
                            <i class="fas fa-shopping-bag"></i>
                            Tus Productos
                        </h2>
                    </div>
                    <div class="cart-stats">
                        <div class="cart-stat">
                            <i class="fas fa-box"></i>
                            <span id="cart-items-count">0</span> productos
                        </div>
                        <div class="cart-stat">
                            <i class="fas fa-layer-group"></i>
                            <span id="cart-units-count">0</span> unidades
                        </div>
                    </div>
                </div>

                <!-- Cart Items Container -->
                <div id="cart-items-container">
                    <!-- Items se cargan dinámicamente -->
                </div>

                <!-- Empty Cart Message -->
                <div id="empty-cart-message" class="empty-cart-premium hidden">
                    <div class="empty-cart-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <h3 class="empty-cart-title">Tu carrito está vacío</h3>
                    <p class="empty-cart-description">
                        ¡Descubre nuestras velas artesanales únicas y encuentra la perfecta para ti!
                    </p>
                    <a href="productos.html" class="btn-shop">
                        <i class="fas fa-arrow-left"></i>
                        <span>Explorar Productos</span>
                    </a>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="summary-card-premium">
                <div class="summary-header">
                    <h3 class="summary-title">
                        <i class="fas fa-receipt"></i>
                        Resumen de Compra
                    </h3>
                </div>

                <div class="summary-content">
                    <div class="summary-line">
                        <span>Subtotal:</span>
                        <span id="subtotal" class="font-semibold">$0.00 MXN</span>
                    </div>
                    <div class="shipping-notice">
                        <i class="fas fa-info-circle"></i>
                        <span>El costo de envío se cotiza por separado</span>
                    </div>
                    <div class="summary-line" id="discount-line" style="display: none;">
                        <span>Descuento:</span>
                        <span id="discount-amount" class="font-semibold text-green-600">-$0.00 MXN</span>
                    </div>
                    <div class="summary-line">
                        <span>Total:</span>
                        <span id="total" class="font-bold">$0.00 MXN</span>
                    </div>
                </div>

                <!-- Código de Descuento -->
                <div class="discount-section">
                    <div class="discount-header">
                        <h4 class="discount-title">
                            <i class="fas fa-tag"></i>
                            Código de Descuento
                        </h4>
                    </div>
                    <div class="discount-input-container">
                        <input type="text" id="discount-code" class="discount-input" placeholder="Ingresa tu código">
                        <button class="btn-apply-discount" id="apply-discount-btn">
                            <i class="fas fa-check"></i>
                            <span>Aplicar</span>
                        </button>
                    </div>
                    <div id="discount-message" class="discount-message hidden"></div>
                    <div class="discount-suggestions">
                        <p class="discount-suggestions-text">Códigos disponibles:</p>
                        <div class="discount-codes">
                            <button class="discount-code-btn"
                                onclick="applyDiscountCode('NUEVOSITIO15')">NUEVOSITIO15</button>
                        </div>
                    </div>
                </div>

                <button class="btn-checkout" id="checkout-btn" disabled>
                    <i class="fas fa-credit-card"></i>
                    <span>Proceder al Pago</span>
                </button>

                <a href="productos.html" class="btn-continue">
                    <i class="fas fa-arrow-left"></i>
                    <span>Seguir Comprando</span>
                </a>
            </div>
        </div>
    </section>

    <!-- Checkout Form Section -->
    <section id="checkout-section" class="checkout-section-premium hidden">
        <div class="container-premium">

            <div class="checkout-header">
                <h2 class="checkout-title">
                    <i class="fas fa-shipping-fast"></i>
                    Información de Envío
                </h2>
                <button class="btn-back" onclick="backToCart()">
                    <i class="fas fa-arrow-left"></i>
                    Regresar al Carrito
                </button>
            </div>

            <form id="checkout-form" class="checkout-form">
                <!-- Información Personal -->
                <div class="form-section">
                    <h3 class="form-section-title">
                        <i class="fas fa-user"></i>
                        Información Personal
                    </h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="firstName" class="form-label">Nombre *</label>
                            <input type="text" id="firstName" name="firstName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName" class="form-label">Apellidos *</label>
                            <input type="text" id="lastName" name="lastName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">Correo Electrónico *</label>
                            <input type="email" id="email" name="email" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="form-label">Teléfono *</label>
                            <input type="tel" id="phone" name="phone" class="form-input" required>
                        </div>
                    </div>
                </div>

                <!-- Dirección de Envío -->
                <div class="form-section">
                    <h3 class="form-section-title">
                        <i class="fas fa-map-marker-alt"></i>
                        Dirección de Envío
                    </h3>
                    <div class="form-grid">
                        <div class="form-group form-group-full">
                            <label for="address" class="form-label">Dirección Completa *</label>
                            <input type="text" id="address" name="address" class="form-input"
                                placeholder="Calle, número, colonia" required>
                        </div>
                        <div class="form-group">
                            <label for="city" class="form-label">Ciudad *</label>
                            <input type="text" id="city" name="city" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="state" class="form-label">Estado *</label>
                            <select id="state" name="state" class="form-input" required>
                                <option value="">Selecciona un estado</option>
                                <option value="CDMX">Ciudad de México</option>
                                <option value="MEX">Estado de México</option>
                                <option value="JAL">Jalisco</option>
                                <option value="NL">Nuevo León</option>
                                <option value="PUE">Puebla</option>
                                <option value="GTO">Guanajuato</option>
                                <option value="VER">Veracruz</option>
                                <option value="YUC">Yucatán</option>
                                <option value="CHIH">Chihuahua</option>
                                <option value="COAH">Coahuila</option>
                                <option value="OAX">Oaxaca</option>
                                <option value="TAM">Tamaulipas</option>
                                <option value="MICH">Michoacán</option>
                                <option value="BCN">Baja California</option>
                                <option value="SIN">Sinaloa</option>
                                <option value="HGO">Hidalgo</option>
                                <option value="SON">Sonora</option>
                                <option value="SLP">San Luis Potosí</option>
                                <option value="TAB">Tabasco</option>
                                <option value="GRO">Guerrero</option>
                                <option value="ZAC">Zacatecas</option>
                                <option value="QRO">Querétaro</option>
                                <option value="MOR">Morelos</option>
                                <option value="DGO">Durango</option>
                                <option value="CHIS">Chiapas</option>
                                <option value="AGS">Aguascalientes</option>
                                <option value="CAMP">Campeche</option>
                                <option value="BCS">Baja California Sur</option>
                                <option value="QROO">Quintana Roo</option>
                                <option value="NAY">Nayarit</option>
                                <option value="TLAX">Tlaxcala</option>
                                <option value="COL">Colima</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="zipCode" class="form-label">Código Postal *</label>
                            <input type="text" id="zipCode" name="zipCode" class="form-input" pattern="[0-9]{5}"
                                maxlength="5" required>
                        </div>
                        <div class="form-group form-group-full">
                            <label for="references" class="form-label">Referencias (Opcional)</label>
                            <textarea id="references" name="references" class="form-input form-textarea" rows="2"
                                placeholder="Entre qué calles, puntos de referencia, etc."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Resumen del Pedido -->
                <div class="form-section">
                    <h3 class="form-section-title">
                        <i class="fas fa-shopping-bag"></i>
                        Resumen del Pedido
                    </h3>
                    <div class="order-summary">
                        <div id="checkout-items" class="checkout-items">
                            <!-- Items se cargan dinámicamente -->
                        </div>
                        <div class="checkout-totals">
                            <div class="checkout-total-line">
                                <span>Subtotal:</span>
                                <span id="checkout-subtotal">$0.00 MXN</span>
                            </div>
                            <div class="checkout-total-line" id="checkout-discount-line" style="display: none;">
                                <span>Descuento:</span>
                                <span id="checkout-discount" class="text-green-600">-$0.00 MXN</span>
                            </div>
                            <div class="checkout-total-line checkout-total-final">
                                <span>Total:</span>
                                <span id="checkout-total">$0.00 MXN</span>
                            </div>
                            <div class="shipping-note">
                                <i class="fas fa-info-circle"></i>
                                <span>El costo de envío se cotizará y enviará por separado</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botones -->
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="backToCart()">
                        <i class="fas fa-arrow-left"></i>
                        Regresar al Carrito
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-arrow-right"></i>
                        Continuar
                    </button>
                </div>
            </form>

            <!-- Quote Section (Step 3) -->
            <div id="quote-section" class="quote-section hidden">

                <div class="quote-content">
                    <!-- Resumen del Cliente -->
                    <div class="quote-card">
                        <h3 class="quote-card-title">
                            <i class="fas fa-user"></i>
                            Información del Cliente
                        </h3>
                        <div class="customer-info" id="customer-summary">
                            <!-- Se llena dinámicamente -->
                        </div>
                    </div>

                    <!-- Dirección de Envío -->
                    <div class="quote-card">
                        <h3 class="quote-card-title">
                            <i class="fas fa-map-marker-alt"></i>
                            Dirección de Envío
                        </h3>
                        <div class="shipping-info" id="shipping-summary">
                            <!-- Se llena dinámicamente -->
                        </div>
                    </div>

                    <!-- Resumen del Pedido -->
                    <div class="quote-card">
                        <h3 class="quote-card-title">
                            <i class="fas fa-shopping-bag"></i>
                            Resumen del Pedido
                        </h3>
                        <div class="order-items" id="final-order-summary">
                            <!-- Se llena dinámicamente -->
                        </div>
                        <div class="order-totals" id="final-totals">
                            <!-- Se llena dinámicamente -->
                        </div>
                    </div>

                    <!-- Instrucciones de Proceso -->
                    <div class="quote-card process-instructions">
                        <h3 class="quote-card-title">
                            <i class="fas fa-info-circle"></i>
                            Proceso de Compra
                        </h3>
                        <!-- Aviso de Construcción -->
                        <div class="construction-banner">
                            <div class="construction-content">
                                <div class="construction-icon">
                                    <i class="fas fa-hard-hat"></i>
                                </div>
                                <div class="construction-info">
                                    <h4>Sitio en Construcción</h4>
                                    <p>Por el momento solo aceptamos transferencias bancarias</p>
                                </div>
                            </div>
                        </div>

                        <!-- Pasos del Proceso -->
                        <div class="process-grid">
                            <div class="process-item">
                                <div class="process-icon">
                                    <span class="process-number">1</span>
                                </div>
                                <div class="process-info">
                                    <h4>Descargar Cotización</h4>
                                    <p>Descarga tu cotización en PDF con todos los detalles del pedido</p>
                                </div>
                            </div>

                            <div class="process-item">
                                <div class="process-icon">
                                    <span class="process-number">2</span>
                                </div>
                                <div class="process-info">
                                    <h4>Enviar por Correo o WhatsApp</h4>
                                    <p>Envía la cotización a:</p>
                                    <div class="contact-buttons">
                                        <a href="mailto:ventas@velasstarlight.com" class="contact-btn email">
                                            <i class="fas fa-envelope"></i>
                                            ventas@velasstarlight.com
                                        </a>
                                        <a href="https://wa.me/525564682112" class="contact-btn whatsapp"
                                            target="_blank">
                                            <i class="fab fa-whatsapp"></i>
                                            WhatsApp
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="process-item">
                                <div class="process-icon">
                                    <span class="process-number">3</span>
                                </div>
                                <div class="process-info">
                                    <h4>Cotización de Envío</h4>
                                    <p>Te contactaremos para cotizar el costo de envío según tu ubicación</p>
                                </div>
                            </div>

                            <div class="process-item">
                                <div class="process-icon">
                                    <span class="process-number">4</span>
                                </div>
                                <div class="process-info">
                                    <h4>Confirmación y Pago</h4>
                                    <p>Una vez confirmado el pedido y el envío, procederemos con el pago por
                                        transferencia</p>
                                </div>
                            </div>

                            <div class="process-item">
                                <div class="process-icon">
                                    <span class="process-number">5</span>
                                </div>
                                <div class="process-info">
                                    <h4>Entrega</h4>
                                    <p>Preparamos tu pedido y lo enviamos a la dirección especificada</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Acciones -->
                    <div class="quote-actions">
                        <button class="btn-download" onclick="generatePDF()">
                            <i class="fas fa-download"></i>
                            Descargar Cotización PDF
                        </button>
                        <button class="btn-email" onclick="sendByEmail()">
                            <i class="fas fa-envelope"></i>
                            Enviar por Correo
                        </button>
                        <button class="btn-whatsapp" onclick="sendByWhatsApp()">
                            <i class="fab fa-whatsapp"></i>
                            Enviar por WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- JavaScript -->
    <script>
        // Variables globales
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const SHIPPING_COST = 120;
        let appliedDiscount = JSON.parse(localStorage.getItem('appliedDiscount')) || null;

        // Códigos de descuento disponibles
        const DISCOUNT_CODES = {
            'NUEVOSITIO15': { percentage: 15, description: '15% de descuento por nuevo sitio web' }
        };

        // Función para agregar productos de prueba (solo para testing)
        function addTestProducts() {
            const testProducts = [
                {
                    id: 'test-1',
                    name: 'Vela Aromática Lavanda',
                    category: 'Vela',
                    price: 210.00,
                    quantity: 1,
                    image: '../images/vela-lavanda.jpg',
                    fragrance: 'Lavanda',
                    color: 'Morado',
                    size: '200 gr'
                },
                {
                    id: 'test-2',
                    name: 'Vela Halloween Fantasma',
                    category: 'Vela',
                    price: 160.00,
                    quantity: 2,
                    image: '../images/vela-halloween.jpg',
                    fragrance: 'Incienso',
                    color: 'Naranja',
                    size: '150 gr'
                },
                {
                    id: 'test-3',
                    name: 'Elixir Facial con Ácido Hialurónico',
                    category: 'Belleza',
                    price: 400.00,
                    quantity: 1,
                    image: '../images/elixir-facial.jpg',
                    fragrance: 'Frutos Rojos',
                    color: 'Dorado',
                    size: '50 mL'
                }
            ];

            // Solo agregar si el carrito está vacío
            if (cart.length === 0) {
                cart = testProducts;
                saveCart();
                updateCartDisplay();
                console.log('Productos de prueba agregados al carrito');
            }
        }

        // Inicialización
        document.addEventListener('DOMContentLoaded', function () {
            // Recargar carrito desde localStorage
            cart = JSON.parse(localStorage.getItem('cart')) || [];
            console.log('Carrito cargado desde localStorage:', cart);

            initializeCart();
            setupEventListeners();
            updateCartDisplay();

            // Agregar productos de prueba si el carrito está vacío
            // addTestProducts(); // Descomenta esta línea para testing
        });

        // Configurar event listeners
        function setupEventListeners() {
            // Mobile menu toggle
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');

            if (menuToggle && mobileMenu) {
                menuToggle.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            // Header scroll effect
            window.addEventListener('scroll', () => {
                const header = document.getElementById('header');
                if (header) {
                    if (window.scrollY > 50) {
                        header.classList.add('scrolled');
                    } else {
                        header.classList.remove('scrolled');
                    }
                }
            });

            // Checkout button
            const checkoutBtn = document.getElementById('checkout-btn');
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', handleCheckout);
            }

            // Discount code functionality
            const applyDiscountBtn = document.getElementById('apply-discount-btn');
            const discountInput = document.getElementById('discount-code');

            if (applyDiscountBtn) {
                applyDiscountBtn.addEventListener('click', handleApplyDiscount);
            }

            if (discountInput) {
                discountInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleApplyDiscount();
                    }
                });
            }

            // Checkout form functionality
            const checkoutForm = document.getElementById('checkout-form');
            if (checkoutForm) {
                checkoutForm.addEventListener('submit', handleCheckoutSubmit);
            }

            // Filter buttons
            const cartFilter = document.getElementById('cart-filter');
            const summaryFilter = document.getElementById('summary-filter');

            if (cartFilter) {
                cartFilter.addEventListener('click', () => {
                    document.querySelector('.cart-items-premium').scrollIntoView({ behavior: 'smooth' });
                });
            }

            if (summaryFilter) {
                summaryFilter.addEventListener('click', () => {
                    document.querySelector('.summary-card-premium').scrollIntoView({ behavior: 'smooth' });
                });
            }
        }

        // Inicializar carrito
        function initializeCart() {
            renderCartItems();
            updateCartStats();
            updateSummary();
            loadAppliedDiscount();
        }

        // Cargar descuento aplicado al inicializar
        function loadAppliedDiscount() {
            if (appliedDiscount) {
                const discountInput = document.getElementById('discount-code');
                if (discountInput) {
                    discountInput.value = appliedDiscount.code;
                    discountInput.classList.add('discount-applied');
                }

                showDiscountMessage(`Código aplicado: ${appliedDiscount.description}`, 'success');

                // Marcar botón de código como aplicado
                const codeButtons = document.querySelectorAll('.discount-code-btn');
                codeButtons.forEach(btn => {
                    if (btn.textContent === appliedDiscount.code) {
                        btn.classList.add('discount-applied');
                    }
                });
            }
        }

        // Renderizar items del carrito
        function renderCartItems() {
            console.log('renderCartItems called with cart:', cart);
            const container = document.getElementById('cart-items-container');
            const emptyMessage = document.getElementById('empty-cart-message');

            if (!container) {
                console.log('Cart container not found!');
                return;
            }

            if (cart.length === 0) {
                container.innerHTML = '';
                if (emptyMessage) {
                    emptyMessage.classList.remove('hidden');
                }
                return;
            }

            if (emptyMessage) {
                emptyMessage.classList.add('hidden');
            }

            // Debug: mostrar datos del carrito en consola
            console.log('Cart data:', cart);
            cart.forEach((item, index) => {
                console.log(`Item ${index}:`, {
                    id: item.id,
                    name: item.name,
                    category: item.category,
                    price: item.price,
                    quantity: item.quantity,
                    fullItem: item
                });
            });

            console.log('About to render cart items. Cart length:', cart.length);
            container.innerHTML = cart.map(item => `
                <div class="product-card-premium" data-id="${item.id}">
                    <img src="${item.image}" alt="${item.name}" class="product-image-premium">
                    
                    <div class="product-info-premium">
                        <div class="product-category-premium">${(item.category || item.type || item.categoria || 'PRODUCTO').toUpperCase()}</div>
                        <h3 class="product-title-premium">${item.name || item.title || 'Producto'}</h3>
                        
                        <div class="product-features-premium">
                            ${item.fragrance ? `<span class="product-feature-premium"><i class="fas fa-leaf"></i> ${item.fragrance}</span>` : ''}
                            ${item.color ? `<span class="product-feature-premium"><i class="fas fa-palette"></i> ${item.color}</span>` : ''}
                            ${item.size ? `<span class="product-feature-premium"><i class="fas fa-ruler"></i> ${item.size}</span>` : ''}
                        </div>

                        <div class="product-controls-premium">
                            <div class="quantity-controls">
                                <button class="qty-btn qty-minus" data-product-id="${item.id}" type="button">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="qty-display">${item.quantity}</span>
                                <button class="qty-btn qty-plus" data-product-id="${item.id}" type="button">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>

                            <div class="product-price-premium">
                                <div class="price-current">$${((parseFloat(item.price) || 0) * (parseInt(item.quantity) || 1)).toFixed(2)} MXN</div>
                                <div class="price-unit">$${(parseFloat(item.price) || 0).toFixed(2)} c/u</div>
                            </div>

                            <button class="remove-btn" data-product-id="${item.id}" type="button">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            console.log('Cart items rendered. HTML updated.');

            // Configurar event listeners para los botones
            setupCartButtonListeners();
        }

        // Configurar event listeners para botones del carrito
        function setupCartButtonListeners() {
            const container = document.getElementById('cart-items-container');
            if (!container) return;

            // Remover listeners anteriores si existen
            container.removeEventListener('click', handleCartButtonClick);

            // Agregar event listener con delegation
            container.addEventListener('click', handleCartButtonClick);
        }

        // Manejar clicks en botones del carrito
        function handleCartButtonClick(event) {
            const target = event.target.closest('button');
            if (!target) return;

            const productId = target.getAttribute('data-product-id');
            if (!productId) return;

            // Obtener la cantidad actual directamente del carrito
            console.log('Looking for productId:', productId, 'type:', typeof productId);
            console.log('Cart items IDs:', cart.map(item => ({ id: item.id, type: typeof item.id })));

            const item = cart.find(item => String(item.id) === String(productId));
            if (!item) {
                console.log('Item not found in cart for productId:', productId);
                return;
            }

            console.log('Found item:', item);

            if (target.classList.contains('qty-minus')) {
                window.updateQuantity(productId, item.quantity - 1);
            } else if (target.classList.contains('qty-plus')) {
                window.updateQuantity(productId, item.quantity + 1);
            } else if (target.classList.contains('remove-btn')) {
                window.removeFromCart(productId);
            }
        }

        // Actualizar cantidad
        window.updateQuantity = function (productId, newQuantity) {
            console.log('updateQuantity called:', productId, newQuantity);
            console.log('Current cart before update:', cart);

            if (newQuantity <= 0) {
                window.removeFromCart(productId);
                return;
            }

            const itemIndex = cart.findIndex(item => String(item.id) === String(productId));
            console.log('Found item at index:', itemIndex);

            if (itemIndex !== -1) {
                console.log('Item before update:', cart[itemIndex]);
                cart[itemIndex].quantity = newQuantity;
                console.log('Item after update:', cart[itemIndex]);
                console.log('Cart after update:', cart);

                saveCart();
                updateCartDisplay();
                showToast('Cantidad actualizada', 'success');
            } else {
                console.log('Item not found in cart for productId:', productId);
            }
        }

        // Remover del carrito
        window.removeFromCart = function (productId) {
            console.log('removeFromCart called:', productId);
            cart = cart.filter(item => String(item.id) !== String(productId));
            saveCart();
            updateCartDisplay();
            showToast('Producto eliminado del carrito', 'success');
        }

        // Actualizar estadísticas del carrito
        function updateCartStats() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const uniqueItems = cart.length;

            // Actualizar contadores en header
            const cartCounts = document.querySelectorAll('#cart-count, #cart-count-mobile');
            cartCounts.forEach(count => {
                if (count) count.textContent = totalItems;
            });

            // Actualizar stats en hero
            const heroItemsCount = document.getElementById('hero-items-count');
            const heroUnitsCount = document.getElementById('hero-units-count');
            if (heroItemsCount) heroItemsCount.textContent = uniqueItems;
            if (heroUnitsCount) heroUnitsCount.textContent = totalItems;

            // Actualizar stats en cart header
            const cartItemsCount = document.getElementById('cart-items-count');
            const cartUnitsCount = document.getElementById('cart-units-count');
            if (cartItemsCount) cartItemsCount.textContent = uniqueItems;
            if (cartUnitsCount) cartUnitsCount.textContent = totalItems;
        }

        // Actualizar resumen
        function updateSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let discountAmount = 0;

            // Calcular descuento si está aplicado
            if (appliedDiscount && subtotal > 0) {
                discountAmount = (subtotal * appliedDiscount.percentage) / 100;
            }

            const total = subtotal - discountAmount;

            // Actualizar elementos del DOM
            const subtotalEl = document.getElementById('subtotal');

            const discountLine = document.getElementById('discount-line');
            const discountAmountEl = document.getElementById('discount-amount');
            const totalEl = document.getElementById('total');
            const checkoutBtn = document.getElementById('checkout-btn');

            if (subtotalEl) subtotalEl.textContent = `$${subtotal.toFixed(2)} MXN`;
            if (totalEl) totalEl.textContent = `$${total.toFixed(2)} MXN`;



            // Mostrar/ocultar línea de descuento
            if (appliedDiscount && discountAmount > 0) {
                if (discountLine) discountLine.style.display = 'flex';
                if (discountAmountEl) discountAmountEl.textContent = `-$${discountAmount.toFixed(2)} MXN`;
            } else {
                if (discountLine) discountLine.style.display = 'none';
            }

            // Habilitar/deshabilitar botón de checkout
            if (checkoutBtn) {
                if (cart.length > 0) {
                    checkoutBtn.disabled = false;
                    checkoutBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    checkoutBtn.disabled = true;
                    checkoutBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }
            }
        }

        // Actualizar display completo del carrito
        function updateCartDisplay() {
            renderCartItems();
            updateCartStats();
            updateSummary();
        }

        // Guardar carrito en localStorage
        function saveCart() {
            console.log('Saving cart to localStorage:', cart);
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Guardar descuento aplicado
        function saveDiscount() {
            localStorage.setItem('appliedDiscount', JSON.stringify(appliedDiscount));
        }

        // Manejar aplicación de código de descuento
        function handleApplyDiscount() {
            const discountInput = document.getElementById('discount-code');
            const applyBtn = document.getElementById('apply-discount-btn');

            if (!discountInput || !applyBtn) return;

            const code = discountInput.value.trim().toUpperCase();

            if (!code) {
                showDiscountMessage('Por favor ingresa un código de descuento', 'error');
                return;
            }

            // Deshabilitar botón temporalmente
            applyBtn.disabled = true;
            applyBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Aplicando...</span>';

            // Simular verificación del código
            setTimeout(() => {
                if (DISCOUNT_CODES[code]) {
                    applyDiscountCode(code);
                } else {
                    showDiscountMessage('Código de descuento inválido', 'error');
                }

                // Rehabilitar botón
                applyBtn.disabled = false;
                applyBtn.innerHTML = '<i class="fas fa-check"></i><span>Aplicar</span>';
            }, 1000);
        }

        // Aplicar código de descuento
        function applyDiscountCode(code) {
            const discountInput = document.getElementById('discount-code');

            if (DISCOUNT_CODES[code]) {
                appliedDiscount = {
                    code: code,
                    percentage: DISCOUNT_CODES[code].percentage,
                    description: DISCOUNT_CODES[code].description
                };

                saveDiscount();
                updateCartDisplay();

                if (discountInput) {
                    discountInput.value = code;
                    discountInput.classList.add('discount-applied');
                }

                showDiscountMessage(`¡Código aplicado! ${appliedDiscount.description}`, 'success');

                // Marcar botón de código como aplicado
                const codeButtons = document.querySelectorAll('.discount-code-btn');
                codeButtons.forEach(btn => {
                    if (btn.textContent === code) {
                        btn.classList.add('discount-applied');
                    }
                });

            } else {
                showDiscountMessage('Código de descuento inválido', 'error');
            }
        }

        // Remover código de descuento
        function removeDiscount() {
            appliedDiscount = null;
            localStorage.removeItem('appliedDiscount');

            const discountInput = document.getElementById('discount-code');
            if (discountInput) {
                discountInput.value = '';
                discountInput.classList.remove('discount-applied');
            }

            // Remover clase de botones aplicados
            const codeButtons = document.querySelectorAll('.discount-code-btn');
            codeButtons.forEach(btn => {
                btn.classList.remove('discount-applied');
            });

            updateCartDisplay();
            showDiscountMessage('Código de descuento removido', 'success');
        }

        // Mostrar mensaje de descuento
        function showDiscountMessage(message, type) {
            const messageEl = document.getElementById('discount-message');
            if (!messageEl) return;

            messageEl.className = `discount-message ${type}`;
            messageEl.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                <span>${message}</span>
                ${appliedDiscount ? '<button onclick="removeDiscount()" class="ml-auto text-sm underline">Remover</button>' : ''}
            `;
            messageEl.classList.remove('hidden');

            // Ocultar mensaje después de 5 segundos (solo si es error)
            if (type === 'error') {
                setTimeout(() => {
                    messageEl.classList.add('hidden');
                }, 5000);
            }
        }

        // Manejar checkout
        function handleCheckout() {
            if (cart.length === 0) {
                showToast('Tu carrito está vacío', 'error');
                return;
            }

            // Mostrar formulario de checkout
            showCheckoutForm();
        }

        // Mostrar formulario de checkout
        function showCheckoutForm() {
            const cartSection = document.querySelector('.cart-section-premium');
            const checkoutSection = document.getElementById('checkout-section');

            if (cartSection && checkoutSection) {
                // Ocultar sección del carrito
                cartSection.style.display = 'none';

                // Mostrar sección de checkout
                checkoutSection.classList.remove('hidden');

                // Scroll al top
                window.scrollTo({ top: 0, behavior: 'smooth' });

                // Cargar items del carrito en el formulario
                loadCheckoutItems();
                updateCheckoutSummary();
            }
        }

        // Regresar al carrito
        function backToCart() {
            const cartSection = document.querySelector('.cart-section-premium');
            const checkoutSection = document.getElementById('checkout-section');

            if (cartSection && checkoutSection) {
                // Mostrar sección del carrito
                cartSection.style.display = 'block';

                // Ocultar sección de checkout
                checkoutSection.classList.add('hidden');

                // Scroll al top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Cargar items del carrito en el checkout
        function loadCheckoutItems() {
            const container = document.getElementById('checkout-items');
            if (!container) return;

            container.innerHTML = cart.map(item => `
                <div class="checkout-item">
                    <div class="checkout-item-info">
                        <div class="checkout-item-name">${item.name || 'Producto'}</div>
                        <div class="checkout-item-details">
                            Cantidad: ${item.quantity} | 
                            ${item.fragrance ? `${item.fragrance} | ` : ''}
                            ${item.size ? `${item.size}` : ''}
                        </div>
                    </div>
                    <div class="checkout-item-price">
                        $${((parseFloat(item.price) || 0) * (parseInt(item.quantity) || 1)).toFixed(2)} MXN
                    </div>
                </div>
            `).join('');
        }

        // Actualizar resumen en checkout
        function updateCheckoutSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let discountAmount = 0;

            if (appliedDiscount && subtotal > 0) {
                discountAmount = (subtotal * appliedDiscount.percentage) / 100;
            }

            const total = subtotal - discountAmount;

            // Actualizar elementos
            const checkoutSubtotal = document.getElementById('checkout-subtotal');
            const checkoutDiscountLine = document.getElementById('checkout-discount-line');
            const checkoutDiscount = document.getElementById('checkout-discount');
            const checkoutTotal = document.getElementById('checkout-total');

            if (checkoutSubtotal) checkoutSubtotal.textContent = `$${subtotal.toFixed(2)} MXN`;
            if (checkoutTotal) checkoutTotal.textContent = `$${total.toFixed(2)} MXN`;

            if (appliedDiscount && discountAmount > 0) {
                if (checkoutDiscountLine) checkoutDiscountLine.style.display = 'flex';
                if (checkoutDiscount) checkoutDiscount.textContent = `-$${discountAmount.toFixed(2)} MXN`;
            } else {
                if (checkoutDiscountLine) checkoutDiscountLine.style.display = 'none';
            }
        }

        // Manejar envío del formulario
        function handleCheckoutSubmit(event) {
            event.preventDefault();

            const formData = new FormData(event.target);
            window.currentOrderData = {
                customer: {
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    email: formData.get('email'),
                    phone: formData.get('phone')
                },
                shipping: {
                    address: formData.get('address'),
                    city: formData.get('city'),
                    state: formData.get('state'),
                    zipCode: formData.get('zipCode'),
                    references: formData.get('references')
                },
                items: cart,
                discount: appliedDiscount,
                subtotal: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) - (appliedDiscount ? (cart.reduce((sum, item) => sum + (item.price * item.quantity), 0) * appliedDiscount.percentage) / 100 : 0)
            };

            console.log('Order data:', window.currentOrderData);

            // Ir al paso 3 (cotización)
            showQuoteSection();
        }

        // Mostrar toast notification
        function showToast(message, type = 'success') {
            // Crear elemento toast
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg text-white transform translate-x-full transition-transform duration-300 ${type === 'success' ? 'bg-green-500' : 'bg-red-500'
                }`;
            toast.innerHTML = `
                <div class="flex items-center gap-2">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(toast);

            // Animar entrada
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 100);

            // Remover después de 3 segundos
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Función global para agregar al carrito (usada desde otras páginas)
        window.addToCart = function (product) {
            console.log('addToCart called with:', product);
            console.log('Current cart before adding:', cart);

            const existingItem = cart.find(item => item.id === product.id);

            if (existingItem) {
                existingItem.quantity += 1;
                console.log('Updated existing item quantity:', existingItem);
            } else {
                const newItem = {
                    ...product,
                    quantity: 1
                };
                cart.push(newItem);
                console.log('Added new item to cart:', newItem);
            }

            console.log('Cart after adding:', cart);
            saveCart();
            updateCartDisplay();
            showToast(`${product.name} agregado al carrito`, 'success');
        };

        // Función global para obtener el carrito
        window.getCart = function () {
            return cart;
        };

        // Función global para limpiar el carrito
        window.clearCart = function () {
            cart = [];
            localStorage.removeItem('cart');
            updateCartDisplay();
            showToast('Carrito vaciado', 'success');
        };

        // Función global para recargar productos de prueba
        window.loadTestProducts = function () {
            addTestProducts();
        };

        // Función de prueba para agregar un producto simple
        window.testAddToCart = function () {
            const testProduct = {
                id: 'test-simple-1',
                name: 'Producto de Prueba',
                category: 'Vela',
                price: 150.00,
                image: '../images/placeholder.jpg',
                fragrance: 'Lavanda',
                color: 'Blanco',
                size: '100g'
            };
            window.addToCart(testProduct);
        };

        // Función para limpiar productos de prueba manualmente
        window.clearTestProducts = function () {
            cart = cart.filter(item => !item.id || typeof item.id !== 'string' || !item.id.startsWith('test-'));
            saveCart();
            updateCartDisplay();
            console.log('Productos de prueba eliminados manualmente');
        };

        // Función para forzar re-render (debug)
        window.forceRender = function () {
            console.log('Forcing render with current cart:', cart);
            updateCartDisplay();
        };

        // Función de debug para verificar estado
        window.debugCart = function () {
            console.log('=== CART DEBUG ===');
            console.log('Cart variable:', cart);
            console.log('LocalStorage cart:', JSON.parse(localStorage.getItem('cart') || '[]'));
            console.log('Cart container exists:', !!document.getElementById('cart-items-container'));

            console.log('=== DETAILED ITEMS ===');
            cart.forEach((item, index) => {
                console.log(`Item ${index}:`, JSON.stringify(item, null, 2));
            });
            console.log('==================');
        };

        // Mostrar sección de cotización (Paso 3)
        function showQuoteSection() {
            const checkoutForm = document.getElementById('checkout-form');
            const quoteSection = document.getElementById('quote-section');

            if (checkoutForm && quoteSection) {
                // Ocultar formulario
                checkoutForm.style.display = 'none';

                // Mostrar sección de cotización
                quoteSection.classList.remove('hidden');

                // Actualizar pasos de progreso
                updateProgressSteps(3);

                // Actualizar título
                const title = document.querySelector('.checkout-title');
                if (title) {
                    title.innerHTML = '<i class="fas fa-file-pdf"></i>Resumen Final';
                }

                // Cargar datos en el resumen
                loadQuoteSummary();

                // Scroll al top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Regresar al formulario (del paso 3 al paso 2)
        function backToForm() {
            const checkoutForm = document.getElementById('checkout-form');
            const quoteSection = document.getElementById('quote-section');

            if (checkoutForm && quoteSection) {
                // Mostrar formulario
                checkoutForm.style.display = 'block';

                // Ocultar sección de cotización
                quoteSection.classList.add('hidden');

                // Actualizar pasos de progreso
                updateProgressSteps(2);

                // Actualizar título
                const title = document.querySelector('.checkout-title');
                if (title) {
                    title.innerHTML = '<i class="fas fa-shipping-fast"></i>Información de Envío';
                }

                // Scroll al top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Actualizar pasos de progreso
        function updateProgressSteps(currentStep) {
            const stepInfo = document.getElementById('step-info');
            const stepQuote = document.getElementById('step-quote');

            if (currentStep === 2) {
                // Paso 2 activo
                if (stepInfo) {
                    stepInfo.classList.add('active');
                    stepInfo.classList.remove('completed');
                }
                if (stepQuote) {
                    stepQuote.classList.remove('active', 'completed');
                }
            } else if (currentStep === 3) {
                // Paso 3 activo
                if (stepInfo) {
                    stepInfo.classList.remove('active');
                    stepInfo.classList.add('completed');
                }
                if (stepQuote) {
                    stepQuote.classList.add('active');
                    stepQuote.classList.remove('completed');
                }
            }
        }

        // Cargar resumen en la cotización
        function loadQuoteSummary() {
            if (!window.currentOrderData) return;

            const data = window.currentOrderData;

            // Información del cliente
            const customerSummary = document.getElementById('customer-summary');
            if (customerSummary) {
                customerSummary.innerHTML = `
                    <div class="info-item">
                        <div class="info-label">Nombre</div>
                        <div class="info-value">${data.customer.firstName} ${data.customer.lastName}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Correo</div>
                        <div class="info-value">${data.customer.email}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Teléfono</div>
                        <div class="info-value">${data.customer.phone}</div>
                    </div>
                `;
            }

            // Dirección de envío
            const shippingSummary = document.getElementById('shipping-summary');
            if (shippingSummary) {
                shippingSummary.innerHTML = `
                    <div class="info-item">
                        <div class="info-label">Dirección</div>
                        <div class="info-value">${data.shipping.address}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Ciudad</div>
                        <div class="info-value">${data.shipping.city}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Estado</div>
                        <div class="info-value">${data.shipping.state}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Código Postal</div>
                        <div class="info-value">${data.shipping.zipCode}</div>
                    </div>
                    ${data.shipping.references ? `
                    <div class="info-item">
                        <div class="info-label">Referencias</div>
                        <div class="info-value">${data.shipping.references}</div>
                    </div>
                    ` : ''}
                `;
            }

            // Resumen del pedido
            const orderSummary = document.getElementById('final-order-summary');
            if (orderSummary) {
                orderSummary.innerHTML = data.items.map(item => `
                    <div class="checkout-item">
                        <div class="checkout-item-info">
                            <div class="checkout-item-name">${item.name || 'Producto'}</div>
                            <div class="checkout-item-details">
                                Cantidad: ${item.quantity} | 
                                ${item.fragrance ? `${item.fragrance} | ` : ''}
                                ${item.size ? `${item.size}` : ''}
                            </div>
                        </div>
                        <div class="checkout-item-price">
                            $${((parseFloat(item.price) || 0) * (parseInt(item.quantity) || 1)).toFixed(2)} MXN
                        </div>
                    </div>
                `).join('');
            }

            // Totales
            const finalTotals = document.getElementById('final-totals');
            if (finalTotals) {
                finalTotals.innerHTML = `
                    <div class="checkout-total-line">
                        <span>Subtotal:</span>
                        <span>$${data.subtotal.toFixed(2)} MXN</span>
                    </div>
                    ${data.discount ? `
                    <div class="checkout-total-line">
                        <span>Descuento (${data.discount.code}):</span>
                        <span class="text-green-600">-$${(data.subtotal - data.total).toFixed(2)} MXN</span>
                    </div>
                    ` : ''}
                    <div class="checkout-total-line checkout-total-final">
                        <span>Total:</span>
                        <span>$${data.total.toFixed(2)} MXN</span>
                    </div>
                    <div class="shipping-note">
                        <i class="fas fa-info-circle"></i>
                        <span>El costo de envío se cotizará por separado</span>
                    </div>
                `;
            }
        }

        // Generar ID único de cotización
        function generateQuoteId() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');

            return `VS-${year}${month}${day}-${hours}${minutes}-${random}`;
        }

        // Función para reconstruir datos del pedido desde localStorage si es necesario
        function ensureOrderData() {
            if (!window.currentOrderData || !window.currentOrderData.items || window.currentOrderData.items.length === 0) {
                console.log('🔄 Reconstruyendo datos del pedido desde localStorage...');

                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const appliedDiscount = JSON.parse(localStorage.getItem('appliedDiscount')) || null;

                if (cart.length === 0) {
                    throw new Error('No hay productos en el carrito');
                }

                // Reconstruir currentOrderData básico para PDF
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const total = subtotal - (appliedDiscount ? (subtotal * appliedDiscount.percentage) / 100 : 0);

                window.currentOrderData = {
                    customer: window.currentOrderData?.customer || {
                        firstName: 'Cliente',
                        lastName: '',
                        email: 'cliente@email.com',
                        phone: 'No especificado'
                    },
                    shipping: window.currentOrderData?.shipping || {
                        address: 'Dirección no especificada',
                        city: 'Ciudad',
                        state: 'Estado',
                        zipCode: '00000',
                        references: ''
                    },
                    items: cart,
                    discount: appliedDiscount,
                    subtotal: subtotal,
                    total: total
                };

                console.log('✅ Datos del pedido reconstruidos:', window.currentOrderData);
            }
        }

        // Generar PDF profesional
        function generatePDF() {
            try {
                // Asegurar que tenemos datos del pedido
                ensureOrderData();
                if (!window.currentOrderData) {
                    showToast('Error: No hay datos de pedido disponibles', 'error');
                    return;
                }

                // Validar que hay items en el pedido
                if (!window.currentOrderData.items || !Array.isArray(window.currentOrderData.items) || window.currentOrderData.items.length === 0) {
                    console.error('❌ No hay productos en el pedido:', window.currentOrderData.items);
                    showToast('Error: No hay productos en el pedido para generar PDF', 'error');
                    return;
                }

                if (!window.generateProfessionalQuotePDF) {
                    showToast('Error: Generador de PDF no disponible', 'error');
                    return;
                }
                console.log('🔍 Datos del pedido antes de generar PDF:', window.currentOrderData);
                console.log('🔍 Items del carrito:', window.currentOrderData?.items);
                console.log('🔍 Número de items:', window.currentOrderData?.items?.length);
                console.log('🔍 Carrito desde localStorage:', JSON.parse(localStorage.getItem('cart') || '[]'));

                const quoteId = generateQuoteId();
                const success = window.generateProfessionalQuotePDF(window.currentOrderData, quoteId);

                if (success) {
                    showToast('Cotización PDF generada exitosamente', 'success');
                } else {
                    showToast('Error al generar el PDF. Intenta nuevamente.', 'error');
                }

            } catch (error) {
                console.error('Error generando PDF:', error);
                showToast('Error al generar el PDF. Por favor, inténtalo de nuevo.', 'error');
            }
        }

        // Enviar por correo
        function sendByEmail() {
            if (!window.currentOrderData) {
                showToast('Error: No hay datos de pedido disponibles', 'error');
                return;
            }

            const data = window.currentOrderData;
            const quoteId = generateQuoteId();
            const subject = encodeURIComponent(`Cotización ${quoteId} - Velas Starlight`);

            const body = encodeURIComponent(`Estimado equipo de Velas Starlight,

Solicito cotización para el siguiente pedido:

═══════════════════════════════════════
📋 COTIZACIÓN: ${quoteId}
📅 FECHA: ${new Date().toLocaleDateString('es-MX')}
═══════════════════════════════════════

👤 INFORMACIÓN DEL CLIENTE:
• Nombre: ${data.customer.firstName} ${data.customer.lastName}
• Correo: ${data.customer.email}
• Teléfono: ${data.customer.phone}

📍 DIRECCIÓN DE ENVÍO:
• ${data.shipping.address}
• ${data.shipping.city}, ${data.shipping.state}
• CP: ${data.shipping.zipCode}
${data.shipping.references ? `• Referencias: ${data.shipping.references}` : ''}

🛍️ PRODUCTOS SOLICITADOS:
${data.items.map((item, index) => {
                const itemPrice = parseFloat(item.price) || 0;
                const itemQuantity = parseInt(item.quantity) || 1;
                const itemSubtotal = itemPrice * itemQuantity;
                return `${index + 1}. ${item.name}
   • Cantidad: ${itemQuantity}
   • Precio unitario: $${itemPrice.toFixed(2)} MXN
   • Subtotal: $${itemSubtotal.toFixed(2)} MXN`;
            }).join('\n\n')}

💰 RESUMEN FINANCIERO:
• Total del pedido: $${data.total.toFixed(2)} MXN
${data.discount ? `• Descuento aplicado: ${data.discount.code} (${data.discount.percentage}%)` : ''}
• Costo de envío: Por cotizar

Por favor, proporcionen:
1. Confirmación de disponibilidad de productos
2. Cotización de costo de envío a la dirección indicada
3. Tiempo estimado de entrega
4. Formas de pago disponibles

Quedo atento a su respuesta.

Saludos cordiales.

═══════════════════════════════════════
🌟 VELAS STARLIGHT - Velas Artesanales Premium
📧 ventas@velasstarlight.com
📱 WhatsApp: +52 55 6468 2112
═══════════════════════════════════════`);

            window.open(`mailto:ventas@velasstarlight.com?subject=${subject}&body=${body}`);
            showToast('Cliente de correo abierto con la cotización', 'success');
        }

        // Enviar por WhatsApp
        function sendByWhatsApp() {
            if (!window.currentOrderData) {
                showToast('Error: No hay datos de pedido disponibles', 'error');
                return;
            }

            const data = window.currentOrderData;
            const quoteId = generateQuoteId();

            const message = encodeURIComponent(`🌟 *COTIZACIÓN VELAS STARLIGHT*

📋 *Cotización:* ${quoteId}
📅 *Fecha:* ${new Date().toLocaleDateString('es-MX')}

👤 *CLIENTE:*
• ${data.customer.firstName} ${data.customer.lastName}
• 📧 ${data.customer.email}
• 📱 ${data.customer.phone}

📍 *DIRECCIÓN DE ENVÍO:*
• ${data.shipping.address}
• ${data.shipping.city}, ${data.shipping.state}
• CP: ${data.shipping.zipCode}
${data.shipping.references ? `• Referencias: ${data.shipping.references}` : ''}

🛍️ *PRODUCTOS:*
${data.items.map((item, index) => {
                const itemPrice = parseFloat(item.price) || 0;
                const itemQuantity = parseInt(item.quantity) || 1;
                const itemSubtotal = itemPrice * itemQuantity;
                return `${index + 1}. *${item.name}*
   • Cantidad: ${itemQuantity}
   • Precio: $${itemPrice.toFixed(2)}
   • Subtotal: $${itemSubtotal.toFixed(2)} MXN`;
            }).join('\n\n')}

💰 *TOTAL: $${data.total.toFixed(2)} MXN*
${data.discount ? `🎯 *Descuento:* ${data.discount.code} (${data.discount.percentage}%)` : ''}

Por favor, cotícenme el costo de envío para proceder con el pedido.

¡Gracias! 🙏`);

            const whatsappUrl = `https://wa.me/525564682112?text=${message}`;
            window.open(whatsappUrl, '_blank');
            showToast('WhatsApp abierto con la cotización', 'success');
        }

        // Funciones globales para el checkout
        window.backToCart = backToCart;
        window.showCheckoutForm = showCheckoutForm;
        window.backToForm = backToForm;
        window.generatePDF = generatePDF;
        window.sendByEmail = sendByEmail;
        window.sendByWhatsApp = sendByWhatsApp;
    </script>

    <!-- Footer Rediseñado -->
    <footer class="bg-gradient-to-br from-dark-green via-dark-green to-sage-green text-white relative overflow-hidden">
        <!-- Elementos decorativos -->
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-10 left-10 w-32 h-32 bg-white rounded-full blur-3xl"></div>
            <div class="absolute bottom-10 right-10 w-48 h-48 bg-sage-green rounded-full blur-3xl"></div>
            <div
                class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-leaf-green rounded-full blur-3xl">
            </div>
        </div>

        <div class="relative z-10">
            <!-- Contenido principal del footer -->
            <div class="container mx-auto px-6 py-16">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">

                    <!-- Logo y descripción -->
                    <div class="lg:col-span-2 space-y-6">
                        <div class="flex items-center space-x-3">
                            <img src="../images/logo.png" alt="Velas Starlight"
                                class="h-12 w-auto filter brightness-0 invert">

                        </div>
                        <p class="text-gray-300 leading-relaxed max-w-md">
                            Creamos experiencias sensoriales únicas con velas artesanales y productos de belleza
                            natural, elaborados con amor y dedicación para iluminar tu mundo.
                        </p>


                    </div>

                    <!-- Enlaces rápidos -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold mb-4 text-white">Enlaces Rápidos</h4>
                        <ul class="space-y-3">
                            <li><a href="../index.html"
                                    class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                    <i
                                        class="fa fa-home mr-2 group-hover:scale-110 transition-transform duration-300"></i>Inicio
                                </a></li>
                            <li><a href="productos.html"
                                    class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                    <i
                                        class="fa fa-cube mr-2 group-hover:scale-110 transition-transform duration-300"></i>Productos
                                </a></li>

                            <li><a href="contacto.html"
                                    class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                    <i
                                        class="fa fa-phone mr-2 group-hover:scale-110 transition-transform duration-300"></i>Contacto
                                </a></li>

                        </ul>
                    </div>

                    <!-- Contacto y redes sociales -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold mb-4 text-white">Conecta con Nosotros</h4>

                        <!-- Información de contacto -->
                        <div class="space-y-3 text-gray-300">
                            <a href="mailto:ventas@velasstarlight.com"
                                class="flex items-center space-x-3 hover:text-gray-200 transition-colors">
                                <i class="fa fa-envelope text-white"></i>
                                <span>ventas@velasstarlight.com</span>
                            </a>
                            <a href="tel:+525564682112"
                                class="flex items-center space-x-3 hover:text-gray-200 transition-colors">
                                <i class="fa fa-phone text-white"></i>
                                <span>5564682112</span>
                            </a>

                        </div>

                        <!-- Redes sociales -->
                        <div class="pt-4">
                            <h5 class="font-medium mb-3">Síguenos</h5>
                            <div class="flex space-x-4">
                                <a href="https://wa.me/5564682112" target="_blank"
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-whatsapp text-lg group-hover:text-white"></i>
                                </a>
                                <a href="https://www.instagram.com/velas_starlight/" target="_blank"
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-instagram text-lg group-hover:text-white"></i>
                                </a>
                                <a href="#" target="_blank"
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-facebook-f text-lg group-hover:text-white"></i>
                                </a>
                                <a href="#" target="_blank"
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-tiktok text-lg group-hover:text-white"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Línea divisoria -->
            <div class="border-t border-white/20"></div>

            <!-- Copyright y enlaces legales -->
            <div class="container mx-auto px-6 py-6">
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <div class="text-gray-300 text-sm">
                        <p>&copy; 2025 Velas Starlight. Todos los derechos reservados.</p>
                    </div>
                    <div class="flex items-center space-x-6 text-sm text-gray-300">
                        <a href="terminos.html" class="hover:text-white transition-colors duration-300">Términos
                            y Condiciones</a>
                        <span class="text-gray-500">|</span>
                        <a href="politicas.html" class="hover:text-white transition-colors duration-300">Política
                            de Privacidad</a>
                        <span class="text-gray-500">|</span>
                        <span class="flex items-center space-x-1">
                            <i class="fa fa-heart text-red-400"></i>
                            <span>Hecho con amor</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

</body>

</html>